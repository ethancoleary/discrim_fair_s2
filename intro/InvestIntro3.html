{{ block title }}
    Your Task
{{ endblock }}
{{ block content }}

<style>
  /* Container for the slider section with shaded background */
  #sliderContainer {
    background-color: #f5f7fa;
    border: 2px solid #d1d9e6;
    border-radius: 12px;
    padding: 30px 40px;
    margin: 0 auto 30px auto;
    width: 75%;
    box-shadow: 0px 4px 12px rgba(0,0,0,0.1);
  }

  /* Center the slider container and label */
  #investmentSlider, label {
    display: block;
    margin: 0 auto;
    font-family: Arial, sans-serif;
    font-size: 18px;
    text-align: center;
    font-weight: 500;
  }

  /* Bulkier slider styling */
  #investmentSlider {
    width: 70%;
    margin-top: 20px;
    margin-bottom: 15px;
    height: 20px;
    border-radius: 12px;
    -webkit-appearance: none;
    background: linear-gradient(to right, #dce7f4, #b8d0ed);
    cursor: pointer;
    outline: none;
  }

  /* Bulky slider thumb */
  #investmentSlider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 35px;
    height: 35px;
    background: #4a90e2;
    cursor: pointer;
    border-radius: 50%;
    border: 3px solid #2c5aa0;
    box-shadow: 0px 2px 6px rgba(0,0,0,0.2);
  }

  #investmentSlider::-moz-range-thumb {
    width: 35px;
    height: 35px;
    background: #4a90e2;
    cursor: pointer;
    border-radius: 50%;
    border: 3px solid #2c5aa0;
    box-shadow: 0px 2px 6px rgba(0,0,0,0.2);
  }

  /* Initially hidden slider text */
  #sliderText {
    display: none;
    margin-top: 15px;
  }

  /* Dropdown button styling */
  #dropdownButton {
    background-color: #4a90e2;
    color: white;
    font-size: 16px;
    font-weight: 600;
    border: none;
    border-radius: 8px;
    padding: 12px 25px;
    cursor: pointer;
    margin: 20px auto;
    display: block;
    transition: background-color 0.3s ease;
  }

   #lotteryContainer {
    background-color: #f5f7fa;
    border: 2px solid #d1d9e6;
    border-radius: 12px;
    padding: 20px 20px;
    margin: 0 auto 30px auto;
    width: 75%;
    box-shadow: 0px 4px 12px rgba(0,0,0,0.1);
    text-align: center;
    font-family: Arial, sans-serif;
  }

  #dropdownButton:hover {
    background-color: #357abd;
  }

  /* Dropdown content - initially hidden */
  #investmentInfo {
    display: none;
    background-color: #ffffff;
    border: 1px solid #d1d9e6;
    border-radius: 8px;
    padding: 20px 25px;
    margin: 15px auto;
    width: 75%;
    box-shadow: 0px 3px 8px rgba(0,0,0,0.08);
  }

  /* Style the table for spaciousness and readability */
  #investmentInfo table {
    width: 100%;
    margin: 0 auto 20px auto;
    border-collapse: separate;
    border-spacing: 0 15px;
    font-family: Arial, sans-serif;
    font-size: 16px;
    text-align: center;
  }

  #investmentInfo th, #investmentInfo td {
    padding: 15px 20px;
    border: 1px solid #cccccc;
  }

  #investmentInfo thead th {
    background-color: #e8f0f8;
    font-weight: bold;
  }

  /* Paragraph and info area center alignment */
  #investmentInfo p {
    text-align: center;
    font-family: Arial, sans-serif;
    font-size: 17px;
    margin-bottom: 20px;
    font-weight: 500;
  }
</style>

You have been given an investment budget of 200 tokens, each worth 1 cent.
Your task is to choose the portion of this budget that you wish to invest in a risky project.
The amount not invested is yours to keep.
<br><br>
The project is either a success or a failure.
To determine the outcome of the project, the computer will virtually roll a six-sided die.
<br><br>
<table style="width:100%; border-collapse:collapse;">
  <tr>
    <td style="width:33%; vertical-align:top;">
      Die result:<br>
      <img src="_static/global/success.png" alt="Success" style="max-width:100%; height:auto;"><br>
      (probability 2/6)
    </td>
    <td style="width:67%; vertical-align:top;">
      Your project is successful.<br>
        You gain 2.5 times your investment. <br>
        Your total payment is 200 plus 2.5 times your investment.
    </td>
  </tr>
  <tr>
     <td style="width:33%; vertical-align:top;">
      Die result:<br>
      <img src="_static/global/failure.png" alt="Success" style="max-width:100%; height:auto;"><br>
      (probability 4/6)
    </td>
    <td style="width:67%; vertical-align:top;">
      Your project is a failure.<br>
        You lose your investment. <br>
        Your total payment is 200 minus your investment.
    </td>
  </tr>
</table>

<br><br>
In the next page you must decide how many of your tokens to invest.
<br><br>
    {{ next_button }}

<script type="text/javascript">
var sliderMoved = false;

function updateDisplay(x) {
  var xInt = parseInt(x, 10);

  // Update the hidden form field to record the slider value
  document.getElementById('sliderValueField').value = xInt;

  // Show the slider text only after the slider has been moved
  if (!sliderMoved) {
    sliderMoved = true;
    document.getElementById('sliderText').style.display = 'block';
  }

  document.getElementById('sliderValue').textContent = xInt;
  document.getElementById('investX').textContent = xInt;

  // Calculate values - round up using Math.ceil for any decimal results
  var lotteryHigh = Math.ceil(2.5 * xInt);
  var lotteryLow = -1 * xInt; // Always 0 for Case 2
  var totalHigh = 200 + lotteryHigh
  var totalLow = 200 + lotteryLow

  // Update slider container text
  document.getElementById('totalbonusHigh').textContent = totalHigh;
  document.getElementById('totalbonusLow').textContent = totalLow;

  // Update table cells
  document.getElementById('lotteryEarnHigh').textContent = lotteryHigh;
  document.getElementById('lotteryEarnLow').textContent = lotteryLow;
  document.getElementById('uninvLeft1').textContent = uninv;
  document.getElementById('uninvLeft2').textContent = uninv;
  document.getElementById('totalBonusHigh').textContent = totalHigh;
  document.getElementById('totalBonusLow').textContent = totalLow;
}

// Toggle dropdown visibility
function toggleDropdown() {
  var dropdown = document.getElementById('investmentInfo');
  var button = document.getElementById('dropdownButton');

  if (dropdown.style.display === 'none' || dropdown.style.display === '') {
    dropdown.style.display = 'block';
    button.innerHTML = 'Hide Possible Bonus Breakdown ▲';
  } else {
    dropdown.style.display = 'none';
    button.innerHTML = 'Show Possible Bonus Breakdown ▼';
  }
}

// Initialize display on page load - do not call updateDisplay(0)
window.onload = function() {
  // Leave slider text hidden until moved
}
</script>

{{ endblock }}
